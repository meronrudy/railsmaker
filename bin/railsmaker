#!/usr/bin/env ruby
require "railsmaker"
require "thor"

module RailsMaker
  class CLI < Thor
    include Thor::Actions

    register RailsMaker::Generators::DockerGenerator,
             "remote:init",
             "remote:init SSH_HOST SSH_USER [--key-path=PATH]",
             "Check and install Docker on a remote Ubuntu server"

    register RailsMaker::Generators::AppGenerator, 
             "app", 
             "app APP_NAME DOCKER_USERNAME IP_ADDRESS HOSTNAME [--skip-daisyui]", 
             "Generate a new Rails application"

    register RailsMaker::Generators::SignozGenerator,
             "remote:signoz:server",
             "remote:signoz:server SSH_HOST SSH_USER [--key-path=PATH]",
             "Install SigNoz on a remote server"

    register RailsMaker::Generators::SignozOpentelemetryGenerator,
             "remote:signoz:opentelemetry",
             "remote:signoz:opentelemetry SSH_HOST SSH_USER SIGNOZ_HOST [--key-path=PATH] [--override-hostname=HOSTNAME]",
             "Install SigNoz OpenTelemetry client on a remote server"

    register RailsMaker::Generators::PlausibleGenerator,
             "remote:plausible:server",
             "remote:plausible:server SSH_HOST SSH_USER ANALYTICS_HOST [--key-path=PATH]",
             "Install Plausible Analytics on a remote server"

    def self.exit_on_failure?
      true
    end
  end
end

RailsMaker::CLI.start
