#!/bin/bash
set -e

if ! command -v docker &> /dev/null; then
    echo "Error: Docker is not installed. Please install Docker first."
    echo "Visit https://docs.docker.com/get-docker/ for installation instructions."
    exit 1
fi

if ! command -v docker compose &> /dev/null; then
    echo "Error: Docker Compose is not installed. Please install Docker Compose first."
    echo "Visit https://docs.docker.com/compose/install/ for installation instructions."
    exit 1
fi

if ! command -v git &> /dev/null; then
    echo "Error: Git is not installed. Please install Git first."
    echo "Visit https://git-scm.com/downloads for installation instructions."
    exit 1
fi

git clone -b main https://github.com/SigNoz/signoz.git

cd signoz/deploy/

git checkout v0.71.0

docker compose -f docker/docker-compose.yaml up -d --remove-orphans

docker compose -f docker/generator/infra/docker-compose.yaml up -d --remove-orphans
